<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Dev Notes</title>
  <subtitle>record interesting things in depth</subtitle>
  <link href="/notes/atom.xml" rel="self"/>
  
  <link href="https://cscao.com/notes/"/>
  <updated>2016-08-09T22:00:53.000Z</updated>
  <id>https://cscao.com/notes/</id>
  
  <author>
    <name>Arron Cao</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Developing AOSP with IntelliJ IDEA</title>
    <link href="https://cscao.com/notes/developing-aosp-with-idea/"/>
    <id>https://cscao.com/notes/developing-aosp-with-idea/</id>
    <published>2016-08-09T22:00:53.000Z</published>
    <updated>2016-08-09T22:00:53.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>Although the fact that AOSP already provides IDE-level developing support, the configuration process may still confuse us. In this article, I’ll give a detailed description on how to do this. Note that we need to <a href="https://source.android.com/source/requirements.html" target="_blank" rel="external">build the Android source</a> beforehand.</p>
<a id="more"></a>
<h2 id="IDEA-Configuration"><a href="#IDEA-Configuration" class="headerlink" title="IDEA Configuration"></a>IDEA Configuration</h2><p>We need to configure the IDEA JVM options and platform properties before importing the source code. For specific os platform, please refer to the <a href="https://intellij-support.jetbrains.com/hc/en-us/articles/206544869-Configuring-JVM-options-and-platform-properties" target="_blank" rel="external">official article</a> . </p>
<p>For example, on macOS, the JVM options configuration file is<br><code>~/Library/Preferences/IntelliJIdea2016.2/idea.vmoptions</code>, increase the min and max memory like this (for speed up code parsing) :</p>
<figure class="highlight haml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"># custom IntelliJ IDEA VM options</div><div class="line">-<span class="ruby">Xms1024m</span></div><div class="line">-<span class="ruby">Xmx4096m</span></div><div class="line">-<span class="ruby"><span class="symbol">XX:</span>ReservedCodeCacheSize=<span class="number">240</span>m</span></div><div class="line">-<span class="ruby"><span class="symbol">XX:</span>+UseCompressedOops</span></div></pre></td></tr></table></figure>
<p>For IDEA properties, open (or create) the file <code>~/Library/Preferences/IntelliJIdea2016.2/idea.properties</code> and increase the filesize like (otherwise IDEA won’t parse the big R.java required):</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta"># custom IntelliJ IDEA properties</span></div><div class="line">idea.<span class="built_in">max</span>.intellisense.filesize=<span class="number">15000</span></div></pre></td></tr></table></figure>
<h2 id="AndroidManifest-Configuration"><a href="#AndroidManifest-Configuration" class="headerlink" title="AndroidManifest Configuration"></a>AndroidManifest Configuration</h2><p>If we want to debug the framework as app, we need to create an <code>AndroidManifest.xml</code> under the source code root directory and write the content:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"utf-8"</span><span class="meta">?&gt;</span></span></div><div class="line"><span class="tag">&lt;<span class="name">manifest</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">uses-sdk</span> <span class="attr">android:minSdkVersion</span>=<span class="string">"23"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">manifest</span>&gt;</span></div></pre></td></tr></table></figure>
<p>Now open IDEA and configure the platform settings for AOSP project.<br><img src="media/IDEA-project-configure.png" alt="IDEA-project-configure"></p>
<h2 id="Platform-Settings"><a href="#Platform-Settings" class="headerlink" title="Platform Settings"></a>Platform Settings</h2><h3 id="SDKs"><a href="#SDKs" class="headerlink" title="SDKs"></a>SDKs</h3><ol>
<li>Configure jdk1.7 without library(remove all jars in Classpath) — name as jdk7_nolib<br><img src="media/IDEA-project-jdk.png" alt="IDEA-project-jdk"></li>
</ol>
<ol>
<li>Add Android SDK Build target as Android 6.0 — name as Android_23_jdk7_nolib<br>(select above pre configured no lib jdk1.7 as Java SDK)<br><img src="media/IDEA-project-android-sdk.png" alt="IDEA-project-android-sdk"></li>
</ol>
<h3 id="Project-Settings"><a href="#Project-Settings" class="headerlink" title="Project Settings"></a>Project Settings</h3><ol>
<li>Project<ul>
<li>select above configured Android SDK (Android_23_jdk7_nolib)</li>
<li>Project language level -&gt; 7 - Diamonds…<br><img src="media/IDEA-project-project-sdk.png" alt="IDEA-project-project-sdk"></li>
</ul>
</li>
</ol>
<h3 id="Prepare-Source-Code"><a href="#Prepare-Source-Code" class="headerlink" title="Prepare Source Code"></a>Prepare Source Code</h3><ol>
<li>Under AOSP source root dir, execute command <code>mmm development/tools/idegen</code>, this will generate necessary IDE files. </li>
<li>(Optional) Open file <code>development/tools/idegen/excluded-paths</code> to configure which sub projects you want to import, eg. if I only want to develop framework base, I will exclude any other projects by appending these lines:<pre><code>## Only not exclude frameworks
art
bionic
bootable
bootstrap.bash
build
cts
dalvik
developers
development
device
docs
external
hardware
kernel
libcore
libnativehelper
ndk
packages
pdk
platform_testing
prebuilts
sdk
system
toolchain
tools
</code></pre></li>
<li>After that, type <code>development/tools/idegen/idegen.sh</code>, this will generate Android.iml and Android.ipr files in the source root dir.</li>
<li>Now you can open the Android.ipr through IDEA. After the indexing finishes, we need to configure the rest parts. Open Project Structure:<br><img src="media/IDEA-project-open-structure.png" alt="IDEA-project-open-structure"></li>
</ol>
<p>Under Modules Tab, add Android framework (or just confirm when IDEA pops up a configure Android framework hint).</p>
<ol>
<li><p>In Source Tab, mark out/target/common/R as sources folder<br><img src="media/IDEA-mark-R-as-source.png" alt="IDEA-mark-R-as-source"></p>
</li>
<li><p>In Dependencies Tab, remove all module dependencies except two <code>Module source</code> and <code>Project SDK (Android_23_jdk7_nolib)</code><br><img src="media/IDEA-remove-module-dependencies.png" alt="IDEA-remove-module-dependencies"></p>
</li>
<li><p>(Optional but recommended) For Unregistered VCS root detected info:<br>Go Preferences-&gt;Version Control-&gt;add root and apply</p>
</li>
</ol>
<p>Now enjoy developing the Android source code!</p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><p><a href="https://android.googlesource.com/platform/development/+/master/tools/idegen/README" target="_blank" rel="external">https://android.googlesource.com/platform/development/+/master/tools/idegen/README</a><br><a href="http://www.cnblogs.com/Lefter/p/4176991.html" target="_blank" rel="external">http://www.cnblogs.com/Lefter/p/4176991.html</a><br><a href="https://github.com/android/platform_development/blob/master/tools/idegen/excluded-paths" target="_blank" rel="external">https://github.com/android/platform_development/blob/master/tools/idegen/excluded-paths</a><br><a href="https://shuhaowu.com/blog/setting_up_intellij_with_aosp_development.html" target="_blank" rel="external">https://shuhaowu.com/blog/setting_up_intellij_with_aosp_development.html</a><br><a href="https://www.jetbrains.com/idea/help/increasing-memory-heap.html" target="_blank" rel="external">https://www.jetbrains.com/idea/help/increasing-memory-heap.html</a><br><a href="http://stackoverflow.com/questions/27690431/configure-intellij-idea-such-that-source-detected-in-git-but-unregistered-vcs-ro/29358524#29358524" target="_blank" rel="external">http://stackoverflow.com/questions/27690431/configure-intellij-idea-such-that-source-detected-in-git-but-unregistered-vcs-ro/29358524#29358524</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h2&gt;&lt;p&gt;Although the fact that AOSP already provides IDE-level developing support, the configuration process may still confuse us. In this article, I’ll give a detailed description on how to do this. Note that we need to &lt;a href=&quot;https://source.android.com/source/requirements.html&quot;&gt;build the Android source&lt;/a&gt; beforehand.&lt;/p&gt;
    
    </summary>
    
      <category term="Android" scheme="https://cscao.com/notes/categories/Android/"/>
    
    
      <category term="AOSP" scheme="https://cscao.com/notes/tags/AOSP/"/>
    
      <category term="IDEA" scheme="https://cscao.com/notes/tags/IDEA/"/>
    
      <category term="Android" scheme="https://cscao.com/notes/tags/Android/"/>
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="https://cscao.com/notes/hello-world/"/>
    <id>https://cscao.com/notes/hello-world/</id>
    <published>2016-08-09T22:00:53.000Z</published>
    <updated>2016-08-09T22:00:53.000Z</updated>
    
    <content type="html"><![CDATA[<p>Hello <a href="https://hexo.io/" target="_blank" rel="external">Hexo</a>!</p>
<p>I’m back again, since more than a year ago, I just started writing blog, and after I tried several times, I gave up. The reason is that I’m not ready, I’m just curious for the web things. This time, I’ll begin write something that deserve to write, from machine learning to software developing and maybe some thoughts on my research.</p>
<p>This first post is mainly for testing various features.</p>
<a id="more"></a>
<h2 id="Basics"><a href="#Basics" class="headerlink" title="Basics"></a>Basics</h2><p>This part is about some simple usage of Markdown grammar. i.e.</p>
<h1 id="H1"><a href="#H1" class="headerlink" title="H1"></a>H1</h1><h2 id="H2"><a href="#H2" class="headerlink" title="H2"></a>H2</h2><h3 id="H3"><a href="#H3" class="headerlink" title="H3"></a>H3</h3><h4 id="H4"><a href="#H4" class="headerlink" title="H4"></a>H4</h4><h5 id="H5"><a href="#H5" class="headerlink" title="H5"></a>H5</h5><h6 id="H6"><a href="#H6" class="headerlink" title="H6"></a>H6</h6><figure class="highlight vala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta"># H1</span></div><div class="line"><span class="meta">## H2</span></div><div class="line"><span class="meta">### H3</span></div><div class="line"><span class="meta">#### H4</span></div><div class="line"><span class="meta">##### H5</span></div><div class="line"><span class="meta">###### H6</span></div></pre></td></tr></table></figure>
<p><strong>bold, strong</strong></p>
<p><em>italic, emphasis</em></p>
<p><strong><em>bold and italic</em></strong></p>
<p><del>Delete</del></p>
<p>list:</p>
<ol>
<li>one</li>
<li>two</li>
<li>three<ul>
<li>subone</li>
<li>subtwo</li>
</ul>
</li>
</ol>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">**<span class="keyword">bold, </span><span class="keyword">strong**</span></div><div class="line"></div><div class="line">*<span class="keyword">italic, </span>emphasis*</div><div class="line"></div><div class="line">***<span class="keyword">bold </span><span class="keyword">and </span><span class="keyword">italic***</span></div><div class="line"></div><div class="line">~~Delete~~</div><div class="line"></div><div class="line"><span class="number">1</span>. one</div><div class="line"><span class="number">2</span>. two</div><div class="line"><span class="number">3</span>. three</div><div class="line"> - <span class="keyword">subone</span></div><div class="line"> - <span class="keyword">subtwo</span></div></pre></td></tr></table></figure>
<h2 id="Footnotes"><a href="#Footnotes" class="headerlink" title="Footnotes"></a>Footnotes</h2><p>basic footnote<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup><br>here is an inline footnote<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup><br>and another one<sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup><br>and another one<sup id="fnref:4"><a href="#fn:4" rel="footnote">4</a></sup></p>
<h2 id="Equations"><a href="#Equations" class="headerlink" title="Equations"></a>Equations</h2><p>Simple inline: $a^2 = b^2 + \frac{d}{\sqrt{c}}$.</p>
<p>Display</p>
<p>$$\frac{\partial u}{\partial t}<br>= h^2 \left( \frac{\partial^2 u}{\partial x^2} +<br>\frac{\partial^2 u}{\partial y^2} +<br>\frac{\partial^2 u}{\partial z^2}\right)<br>$$</p>
<p>Aligning equations<br><span>$$\begin{aligned}
\dot{x} &amp; = \sigma(y-x) \\
\dot{y} &amp; = \rho x - y - xz \\
\dot{z} &amp; = -\beta z + xy
\end{aligned}$$</span><!-- Has MathJax --></p>
<p>Equations with numbering<br><span>$$\begin{equation}\label{2.1}
\begin{split}
a =&amp; b+c-d\\
   &amp; {}+e-f\\
  =&amp; g+h\\ 
  =&amp; i
\end{split}
\end{equation}$$</span><!-- Has MathJax --></p>
<p>Equations with cases<br><span>$$f(n) =
\begin{cases}
\frac{n}{2},  &amp; \text{if $n$ is even} \\
3n+1, &amp; \text{if $n$ is odd}
\end{cases}$$</span><!-- Has MathJax --></p>
<h2 id="Blocks"><a href="#Blocks" class="headerlink" title="Blocks"></a>Blocks</h2><div class="alert info"><p>Here is a info alert</p>
</div>
<div class="alert success"><p>Here is a success alert</p>
</div>
<div class="alert warning"><p>Here is a warning alert</p>
</div>
<div class="alert danger"><p>Here is a danger alert</p>
</div>
<div class="alert danger no-icon"><p>Here is a danger alert without icon</p>
</div>
<h2 id="Highlight-Text"><a href="#Highlight-Text" class="headerlink" title="Highlight Text"></a>Highlight Text</h2><span class="highlight-text danger">danger</span>
<span class="highlight-text warning">warning</span>
<span class="highlight-text primary">primary</span>
<span class="highlight-text success">success</span>
<span class="highlight-text cyan">success</span>
<span class="highlight-text yellow">yellow</span>
<span class="highlight-text orange">orange</span>
<span class="highlight-text purple">purple</span>
<span class="highlight-text blue">blue</span>
<span class="highlight-text green">green</span>
<span class="highlight-text red">red</span>
<h2 id="Codes"><a href="#Codes" class="headerlink" title="Codes"></a>Codes</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo new <span class="string">"My New Post"</span></div></pre></td></tr></table></figure>
<figure class="highlight java"><figcaption><span>Java example</span><a href="https://highlightjs.org/" target="_blank" rel="external">Source</a></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * <span class="doctag">@author</span> John Smith &lt;john.smith@example.com&gt;</div><div class="line">*/</div><div class="line"><span class="keyword">package</span> l2f.gameserver.model;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">L2Char</span> <span class="keyword">extends</span> <span class="title">L2Object</span> </span>&#123;</div><div class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Short ERROR = <span class="number">0x0001</span>;</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">moveTo</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z)</span> </span>&#123;</div><div class="line">    _ai = <span class="keyword">null</span>;</div><div class="line">    log(<span class="string">"Should not be called"</span>);</div><div class="line">    <span class="keyword">if</span> (<span class="number">1</span> &gt; <span class="number">5</span>) &#123; <span class="comment">// wtf!?</span></div><div class="line">      <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div></pre></td></tr></table></figure>
<figure class="highlight python"><figcaption><span>Python example</span><a href="https://highlightjs.org/" target="_blank" rel="external">Source</a></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@requires_authorization</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">somefunc</span><span class="params">(param1=<span class="string">''</span>, param2=<span class="number">0</span>)</span>:</span></div><div class="line">    <span class="string">r'''A docstring'''</span></div><div class="line">    <span class="keyword">if</span> param1 &gt; param2: <span class="comment"># interesting</span></div><div class="line">        <span class="keyword">print</span> <span class="string">'Gre\'ater'</span></div><div class="line">    <span class="keyword">return</span> (param2 - param1 + <span class="number">1</span> + <span class="number">0b10l</span>) <span class="keyword">or</span> <span class="keyword">None</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">SomeClass</span>:</span></div><div class="line">    <span class="keyword">pass</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>message = <span class="string">'''interpreter</span></div><div class="line"><span class="meta">... </span>prompt'''</div><div class="line"></div></pre></td></tr></table></figure>
<div id="footnotes"><hr><div id="footnotelist"><ol style="list-style:none; padding-left: 0;"><li id="fn:1"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">1.</span><span style="display: inline-block; vertical-align: top;">basic footnote content</span><a href="#fnref:1" rev="footnote"> ↩</a></li><li id="fn:2"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">2.</span><span style="display: inline-block; vertical-align: top;">inline footnote</span><a href="#fnref:2" rev="footnote"> ↩</a></li><li id="fn:3"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">3.</span><span style="display: inline-block; vertical-align: top;">paragraph<br>footnote<br>content</span><a href="#fnref:3" rev="footnote"> ↩</a></li><li id="fn:4"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">4.</span><span style="display: inline-block; vertical-align: top;">footnote content with some <a href="https://en.wikipedia.org/wiki/Markdown" target="_blank" rel="external">markdown</a></span><a href="#fnref:4" rev="footnote"> ↩</a></li></ol></div></div>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Hello &lt;a href=&quot;https://hexo.io/&quot;&gt;Hexo&lt;/a&gt;!&lt;/p&gt;
&lt;p&gt;I’m back again, since more than a year ago, I just started writing blog, and after I tried several times, I gave up. The reason is that I’m not ready, I’m just curious for the web things. This time, I’ll begin write something that deserve to write, from machine learning to software developing and maybe some thoughts on my research.&lt;/p&gt;
&lt;p&gt;This first post is mainly for testing various features.&lt;/p&gt;
    
    </summary>
    
      <category term="web" scheme="https://cscao.com/notes/categories/web/"/>
    
      <category term="blog" scheme="https://cscao.com/notes/categories/web/blog/"/>
    
    
      <category term="Hexo" scheme="https://cscao.com/notes/tags/Hexo/"/>
    
      <category term="markdown" scheme="https://cscao.com/notes/tags/markdown/"/>
    
      <category term="html" scheme="https://cscao.com/notes/tags/html/"/>
    
  </entry>
  
</feed>
